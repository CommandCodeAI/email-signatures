<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Email Signature Generator</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg: #000000;
            --bg-secondary: #0a0a0a;
            --bg-input: #111111;
            --border: #1a1a1a;
            --border-light: #2a2a2a;
            --border-focus: #444444;
            --text: #ffffff;
            --text-muted: #888888;
            --text-dim: #555555;
            --accent: #ffffff;
            --editor-link: #6ea8fe;
        }

        body {
            font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            width: 90vw;
            max-width: 1400px;
            margin: 0 auto;
        }

        @media (min-width: 768px) {
            .container {
                width: 90vw;
            }
        }

        .header-section {
            border: 1px solid var(--border);
            border-bottom: none;
            position: relative;
            padding: 30px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .corner-box {
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--bg);
            border: 1px solid var(--border-light);
            border-radius: 3px;
            z-index: 99;
        }

        @media (min-width: 640px) {
            .corner-box {
                width: 20px;
                height: 20px;
            }
        }

        .corner-tl { top: 0; left: 0; transform: translate(-50%, -50%); }
        .corner-tr { top: 0; right: 0; transform: translate(50%, -50%); }
        .corner-bl { bottom: 0; left: 0; transform: translate(-50%, 50%); }
        .corner-br { bottom: 0; right: 0; transform: translate(50%, 50%); }

        h1 {
            font-size: 1.5rem;
            font-weight: 500;
            letter-spacing: -0.02em;
        }

        @media (min-width: 768px) {
            h1 {
                font-size: 2rem;
            }
        }

        .comment-prefix {
            color: var(--text-dim);
            margin-right: 8px;
            letter-spacing: -0.2em;
        }

        .help-link {
            color: var(--text-muted);
            font-size: 13px;
            cursor: pointer;
            text-decoration: underline;
            text-underline-offset: 2px;
            transition: color 0.2s;
        }

        .help-link:hover {
            color: var(--text);
        }

        .main-content {
            border: 1px solid var(--border);
            position: relative;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr;
        }

        @media (min-width: 1000px) {
            .content-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .panel {
            padding: 24px;
            position: relative;
        }

        @media (min-width: 1000px) {
            .panel:first-child {
                border-right: 1px solid var(--border);
            }
        }

        @media (max-width: 999px) {
            .panel:first-child {
                border-bottom: 1px solid var(--border);
            }
        }

        .panel-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-title .comment {
            color: var(--text-dim);
            letter-spacing: -0.15em;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-muted);
            margin-bottom: 8px;
            letter-spacing: 0.02em;
        }

        .form-group input {
            width: 100%;
            padding: 12px 14px;
            background: var(--bg-input);
            border: 1px solid var(--border-light);
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
            color: var(--text);
            transition: border-color 0.2s, background-color 0.2s, box-shadow 0.2s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--border-focus);
            background: var(--bg-secondary);
            box-shadow: 0 0 0 3px rgba(255,255,255,0.05);
        }

        .form-group input::placeholder {
            color: var(--text-dim);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
        }

        @media (min-width: 500px) {
            .form-grid-2 {
                grid-template-columns: 1fr 1fr;
            }
        }

        .signature-preview {
            background: #ffffff;
            padding: 24px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
            position: relative;
            min-height: 200px;
        }

        .preview-label {
            position: absolute;
            top: -10px;
            left: 12px;
            background: var(--bg);
            padding: 0 8px;
            font-size: 10px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            border: 1px solid var(--border);
            font-size: 13px;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            border-radius: 4px;
        }

        .btn-primary {
            background: var(--text);
            color: var(--bg);
            border-color: var(--text);
        }

        .btn-primary:hover {
            background: var(--text-muted);
            border-color: var(--text-muted);
        }

        .btn-outline {
            background: transparent;
            color: var(--text);
            border-color: var(--border-light);
        }

        .btn-outline:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }

        .btn-small {
            padding: 8px 14px;
            font-size: 12px;
        }

        .btn-add {
            margin-top: 12px;
            width: 100%;
            border-style: dashed;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .copy-feedback {
            display: none;
            color: var(--text);
            font-size: 11px;
            margin-top: 10px;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
        }

        .copy-feedback.show {
            display: block;
        }

        .footer-section {
            border: 1px solid var(--border);
            border-top: none;
            padding: 20px;
            text-align: center;
        }

        .footer-section p {
            color: var(--text-dim);
            font-size: 11px;
        }

        .email-signature {
            font-family: Arial, Helvetica, sans-serif;
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-light);
            border-radius: 0;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-dim);
        }

        .form-section {
            margin-bottom: 24px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border);
        }

        .form-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .form-section-title {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-dim);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        .editor-scroll {
            max-height: calc(100vh - 250px);
            overflow-y: auto;
            padding-right: 8px;
        }

        .rich-editor {
            min-height: 36px;
            padding: 12px 14px;
            background: var(--bg-input);
            border: 1px solid var(--border-light);
            border-radius: 0 0 4px 4px;
            font-size: 14px;
            font-family: inherit;
            color: var(--text);
            transition: border-color 0.2s, background-color 0.2s, box-shadow 0.2s;
            outline: none;
            line-height: 1.5;
        }

        .rich-editor:focus {
            border-color: var(--border-focus);
            background: var(--bg-secondary);
            box-shadow: 0 0 0 3px rgba(255,255,255,0.05);
        }

        .rich-editor:empty:before {
            content: attr(data-placeholder);
            color: var(--text-dim);
        }

        .rich-editor a {
            color: var(--editor-link) !important;
            text-decoration: underline;
        }

        .editor-toolbar {
            display: flex;
            gap: 4px;
            padding: 8px 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            border-bottom: none;
            border-radius: 4px 4px 0 0;
            flex-wrap: wrap;
        }

        .toolbar-btn {
            padding: 6px 10px;
            background: transparent;
            border: 1px solid transparent;
            color: var(--text-muted);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            border-radius: 3px;
        }

        .toolbar-btn:hover {
            background: var(--border);
            color: var(--text);
            border-color: var(--border-light);
        }

        .toolbar-separator {
            width: 1px;
            background: var(--border);
            margin: 0 4px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            border-radius: 8px;
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 20px;
            cursor: pointer;
            padding: 4px 8px;
        }

        .modal-close:hover {
            color: var(--text);
        }

        .modal-title {
            font-size: 16px;
            margin-bottom: 20px;
            color: var(--text);
            padding-right: 30px;
        }

        .modal .form-group {
            margin-bottom: 14px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .help-content ol {
            padding-left: 20px;
            counter-reset: step;
            list-style: none;
        }

        .help-content li {
            margin-bottom: 12px;
            color: var(--text-muted);
            line-height: 1.6;
            position: relative;
            padding-left: 8px;
            font-size: 13px;
        }

        .help-content li::before {
            counter-increment: step;
            content: counter(step, decimal-leading-zero);
            position: absolute;
            left: -24px;
            color: var(--text-dim);
            font-size: 11px;
        }

        .help-content strong {
            color: var(--text);
            font-weight: 500;
        }

        .help-content code {
            background: var(--bg);
            border: 1px solid var(--border);
            padding: 2px 6px;
            font-size: 11px;
            font-family: inherit;
            border-radius: 3px;
        }

        .help-content a {
            color: var(--text);
            text-decoration: underline;
        }

        .help-tip {
            margin-top: 20px;
            padding: 12px;
            border-left: 2px solid var(--border-light);
            color: var(--text-dim);
            font-size: 12px;
        }

        .help-tip strong {
            color: var(--text-muted);
        }

        .credential-item {
            display: flex;
            gap: 8px;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .credential-item .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .btn-remove {
            padding: 10px 12px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            border-radius: 4px;
            margin-top: 26px;
        }

        .btn-remove:hover {
            background: #331111;
            border-color: #663333;
            color: #ff6666;
        }

        .social-link-item {
            display: flex;
            gap: 8px;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .social-link-item .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .social-link-item .btn-remove {
            margin-top: 26px;
        }

        .inline-editor-wrapper {
            margin-bottom: 16px;
        }

        .inline-editor-wrapper:last-child {
            margin-bottom: 0;
        }

        .inline-editor-wrapper label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-muted);
            margin-bottom: 8px;
            letter-spacing: 0.02em;
        }

        .mini-toolbar {
            display: flex;
            gap: 4px;
            padding: 6px 8px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            border-bottom: none;
            border-radius: 4px 4px 0 0;
        }

        .mini-toolbar .toolbar-btn {
            padding: 4px 8px;
            font-size: 11px;
        }

        .inline-editor {
            min-height: 42px;
            padding: 12px 14px;
            background: var(--bg-input);
            border: 1px solid var(--border-light);
            border-radius: 0 0 4px 4px;
            font-size: 14px;
            font-family: inherit;
            color: var(--text);
            transition: border-color 0.2s, background-color 0.2s, box-shadow 0.2s;
            outline: none;
            line-height: 1.4;
        }

        .inline-editor:focus {
            border-color: var(--border-focus);
            background: var(--bg-secondary);
            box-shadow: 0 0 0 3px rgba(255,255,255,0.05);
        }

        .inline-editor:empty:before {
            content: attr(data-placeholder);
            color: var(--text-dim);
        }

        .inline-editor a {
            color: var(--editor-link) !important;
            text-decoration: underline;
        }

        .preview-panel {
            position: sticky;
            top: 20px;
        }

        .field-hint {
            font-size: 11px;
            color: var(--text-dim);
            margin-top: 6px;
            line-height: 1.4;
        }

        .field-hint kbd {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 1px 5px;
            border-radius: 3px;
            font-size: 10px;
            font-family: inherit;
        }

        .collapsible-section {
            border: 1px solid var(--border);
            border-radius: 4px;
            margin-bottom: 16px;
        }

        .collapsible-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 14px;
            cursor: pointer;
            background: var(--bg-secondary);
            border-radius: 4px;
            transition: background 0.2s;
        }

        .collapsible-header:hover {
            background: var(--bg-input);
        }

        .collapsible-header .section-title {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-muted);
            letter-spacing: 0.02em;
        }

        .collapsible-header .toggle-icon {
            color: var(--text-dim);
            font-size: 14px;
            transition: transform 0.2s;
        }

        .collapsible-section.open .toggle-icon {
            transform: rotate(180deg);
        }

        .collapsible-content {
            display: none;
            padding: 16px 14px;
            border-top: 1px solid var(--border);
        }

        .collapsible-section.open .collapsible-content {
            display: block;
        }

        .collapsible-section.open .collapsible-header {
            border-radius: 4px 4px 0 0;
        }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: var(--text-dim);
            font-size: 13px;
        }

        .color-preview {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 1px solid var(--border-light);
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-section">
            <div class="corner-box corner-tl"></div>
            <div class="corner-box corner-tr"></div>
            <div class="header-left">
                <h1><span class="comment-prefix">//</span>Email Signature</h1>
                <span class="help-link" onclick="openHelpModal()">How to add to Gmail?</span>
            </div>
        </div>

        <div class="main-content">
            <div class="corner-box corner-bl"></div>
            <div class="corner-box corner-br"></div>

            <div class="content-grid">
                <div class="panel">
                    <h3 class="panel-title"><span class="comment">//</span> Editor</h3>

                    <div class="editor-scroll">
                        <div class="form-section">
                            <div class="form-section-title">Basic Info</div>
                            <div class="form-grid form-grid-2">
                                <div class="form-group">
                                    <label>Full Name</label>
                                    <input type="text" id="name" value="YOUR NAME" placeholder="Enter your name" oninput="updatePreview()">
                                </div>
                                <div class="form-group">
                                    <label>Name Link (optional)</label>
                                    <input type="text" id="nameLink" placeholder="https://twitter.com/..." oninput="updatePreview()">
                                </div>
                            </div>
                            <div class="inline-editor-wrapper">
                                <label>Role & Company</label>
                                <div class="mini-toolbar">
                                    <button class="toolbar-btn" onclick="execInlineCmd('bold', 'roleEditor')" title="Bold"><b>B</b></button>
                                    <button class="toolbar-btn" onclick="openInlineLinkModal('roleEditor')" title="Add Link">Link</button>
                                </div>
                                <div class="inline-editor" id="roleEditor" contenteditable="true" data-placeholder="e.g., Developer at Company" oninput="updatePreview()" onpaste="handlePaste(event)">ROLE at ⌘ <a href="https://commandcode.ai">CommandCode.ai</a></div>
                                <div class="field-hint">Select text + <kbd>⌘K</kbd> to add link · Use // to separate companies</div>
                            </div>
                        </div>

                        <div class="form-section">
                            <div class="form-section-title">Tagline (Optional)</div>
                            <div class="inline-editor-wrapper">
                                <label>Short Description</label>
                                <div class="mini-toolbar">
                                    <button class="toolbar-btn" onclick="execInlineCmd('bold', 'taglineEditor')" title="Bold"><b>B</b></button>
                                    <button class="toolbar-btn" onclick="openInlineLinkModal('taglineEditor')" title="Add Link">Link</button>
                                </div>
                                <div class="inline-editor" id="taglineEditor" contenteditable="true" data-placeholder="e.g., Coding agent with your coding taste." oninput="updatePreview()" onpaste="handlePaste(event)"></div>
                                <div class="field-hint">Use // to separate multiple taglines</div>
                            </div>
                        </div>

                        <div class="collapsible-section">
                            <div class="collapsible-header" onclick="toggleSection(this)">
                                <span class="section-title">Social Links</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="collapsible-content">
                                <div id="socialLinksContainer">
                                </div>
                                <button class="btn btn-outline btn-small btn-add" onclick="addSocialLink()">+ Add Social Link</button>
                            </div>
                        </div>

                        <div class="collapsible-section">
                            <div class="collapsible-header" onclick="toggleSection(this)">
                                <span class="section-title">Credentials & Awards</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="collapsible-content">
                                <div class="field-hint" style="margin-bottom: 12px;">Each credential appears on its own line. Use · to separate items within a line.</div>
                                <div id="credentialsContainer">
                                </div>
                                <button class="btn btn-outline btn-small btn-add" onclick="addCredential()">+ Add Credential Line</button>
                            </div>
                        </div>

                        <div class="collapsible-section">
                            <div class="collapsible-header" onclick="toggleSection(this)">
                                <span class="section-title">Colors</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="collapsible-content">
                                <div class="form-grid form-grid-2">
                                    <div class="form-group">
                                        <label>Name Badge Background</label>
                                        <input type="color" id="colorNameBg" value="#1e1e3f" oninput="updatePreview()" style="height: 40px; padding: 4px; cursor: pointer;">
                                    </div>
                                    <div class="form-group">
                                        <label>Name Badge Text</label>
                                        <input type="color" id="colorNameText" value="#ffffff" oninput="updatePreview()" style="height: 40px; padding: 4px; cursor: pointer;">
                                    </div>
                                    <div class="form-group">
                                        <label>Body Text</label>
                                        <input type="color" id="colorBodyText" value="#444444" oninput="updatePreview()" style="height: 40px; padding: 4px; cursor: pointer;">
                                    </div>
                                    <div class="form-group">
                                        <label>Link Color</label>
                                        <input type="color" id="colorLink" value="#444444" oninput="updatePreview()" style="height: 40px; padding: 4px; cursor: pointer;">
                                    </div>
                                    <div class="form-group">
                                        <label>Separator Color</label>
                                        <input type="color" id="colorSeparator" value="#9291b5" oninput="updatePreview()" style="height: 40px; padding: 4px; cursor: pointer;">
                                    </div>
                                    <div class="form-group">
                                        <label>Credential Text</label>
                                        <input type="color" id="colorCredText" value="#8f8f8f" oninput="updatePreview()" style="height: 40px; padding: 4px; cursor: pointer;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="preview-panel">
                        <h3 class="panel-title"><span class="comment">//</span> Preview</h3>

                        <div class="signature-preview">
                            <span class="preview-label">Output</span>
                            <div id="signatureOutput" class="email-signature"></div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" onclick="copySignature()">Copy Signature</button>
                            <button class="btn btn-outline" onclick="copyHtml()">Copy HTML</button>
                        </div>
                        <p id="copyFeedback" class="copy-feedback">Copied to clipboard!</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer-section">
            <p>Built for ⌘ CommandCode.ai</p>
        </div>
    </div>

    <div id="linkModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeLinkModal()">×</button>
            <div class="modal-title">Insert Link</div>
            <div class="form-group">
                <label>Link Text</label>
                <input type="text" id="linkText" placeholder="Display text">
            </div>
            <div class="form-group">
                <label>URL</label>
                <input type="text" id="linkUrl" placeholder="https://example.com">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-outline btn-small" onclick="closeLinkModal()">Cancel</button>
                <button class="btn btn-primary btn-small" onclick="insertLink()">Insert</button>
            </div>
        </div>
    </div>

    <div id="helpModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeHelpModal()">×</button>
            <div class="modal-title">How to Add to Gmail</div>
            <div class="help-content">
                <ol>
                    <li>Click the <strong>Copy Signature</strong> button</li>
                    <li>Open <a href="https://mail.google.com" target="_blank">Gmail</a> in your browser</li>
                    <li>Click the <strong>Settings gear icon</strong> in the top right</li>
                    <li>Click <strong>See all settings</strong></li>
                    <li>Scroll down to the <strong>Signature</strong> section</li>
                    <li>Click <strong>+ Create new</strong> and give it a name</li>
                    <li>Click inside the signature text box and press <code>Ctrl+V</code> (Windows) or <code>Cmd+V</code> (Mac) to paste</li>
                    <li>Scroll to the bottom and click <strong>Save Changes</strong></li>
                </ol>
                <div class="help-tip">
                    <strong>Tip:</strong> Make sure to select your new signature as the default for new emails and replies in the signature settings.
                </div>
            </div>
        </div>
    </div>

    <script>
        let activeEditor = null;
        let savedSelection = null;

        function openHelpModal() {
            document.getElementById('helpModal').classList.add('show');
        }

        function closeHelpModal() {
            document.getElementById('helpModal').classList.remove('show');
        }

        function toggleSection(header) {
            const section = header.parentElement;
            section.classList.toggle('open');
        }

        function getSocialLinks() {
            const links = [];
            document.querySelectorAll('.social-link-item').forEach(item => {
                const inputs = item.querySelectorAll('input');
                const platform = inputs[0].value.trim();
                const url = inputs[1].value.trim();
                if (platform && url) {
                    links.push({ platform, url });
                }
            });
            return links;
        }

        function getCredentials() {
            const creds = [];
            document.querySelectorAll('.credential-item').forEach(item => {
                const editor = item.querySelector('.rich-editor');
                if (editor) {
                    const html = editor.innerHTML.trim();
                    if (html && html !== '<br>') {
                        creds.push(html);
                    }
                }
            });
            return creds;
        }

        function addSocialLink() {
            const container = document.getElementById('socialLinksContainer');
            const item = document.createElement('div');
            item.className = 'social-link-item';
            item.innerHTML = `
                <div class="form-group" style="flex: 0 0 100px;">
                    <label>Platform</label>
                    <input type="text" placeholder="e.g., LinkedIn" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>URL</label>
                    <input type="text" placeholder="https://..." oninput="updatePreview()">
                </div>
                <button class="btn-remove" onclick="removeSocialLink(this)" title="Remove">×</button>
            `;
            container.appendChild(item);
        }

        function removeSocialLink(btn) {
            btn.parentElement.remove();
            updatePreview();
        }

        function addCredential() {
            const container = document.getElementById('credentialsContainer');
            const item = document.createElement('div');
            item.className = 'credential-item';
            const id = 'cred_' + Date.now();
            item.innerHTML = `
                <div class="form-group" style="flex: 1;">
                    <div class="editor-toolbar">
                        <button class="toolbar-btn" onclick="execCmd('bold', this)" title="Bold"><b>B</b></button>
                        <button class="toolbar-btn" onclick="execCmd('italic', this)" title="Italic"><i>I</i></button>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" onclick="openLinkModal(this)" title="Insert Link">Link</button>
                    </div>
                    <div class="rich-editor" id="${id}" contenteditable="true" data-placeholder="e.g., Award Winner · Board Member · GitHub Star" oninput="updatePreview()" onpaste="handlePaste(event)"></div>
                </div>
                <button class="btn-remove" onclick="removeCredential(this)" title="Remove" style="margin-top: 0;">×</button>
            `;
            container.appendChild(item);
        }

        function removeCredential(btn) {
            btn.parentElement.remove();
            updatePreview();
        }

        function execCmd(cmd, btn) {
            const toolbar = btn.closest('.editor-toolbar');
            const editor = toolbar.nextElementSibling;
            editor.focus();
            document.execCommand(cmd, false, null);
            updatePreview();
        }

        function execInlineCmd(cmd, editorId) {
            const editor = document.getElementById(editorId);
            editor.focus();
            document.execCommand(cmd, false, null);
            updatePreview();
        }

        function openLinkModal(btn) {
            const toolbar = btn.closest('.editor-toolbar');
            activeEditor = toolbar.nextElementSibling;

            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                savedSelection = selection.getRangeAt(0).cloneRange();
                document.getElementById('linkText').value = selection.toString();
            }

            document.getElementById('linkUrl').value = '';
            document.getElementById('linkModal').classList.add('show');
            setTimeout(() => document.getElementById('linkUrl').focus(), 50);
        }

        function openInlineLinkModal(editorId) {
            activeEditor = document.getElementById(editorId);
            activeEditor.focus();

            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                savedSelection = selection.getRangeAt(0).cloneRange();
                document.getElementById('linkText').value = selection.toString();
            }

            document.getElementById('linkUrl').value = '';
            document.getElementById('linkModal').classList.add('show');
            setTimeout(() => document.getElementById('linkUrl').focus(), 50);
        }

        function closeLinkModal() {
            document.getElementById('linkModal').classList.remove('show');
            activeEditor = null;
            savedSelection = null;
        }

        function insertLink() {
            const text = document.getElementById('linkText').value;
            const url = document.getElementById('linkUrl').value;

            if (!url) {
                closeLinkModal();
                return;
            }

            if (activeEditor && savedSelection) {
                activeEditor.focus();
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(savedSelection);

                const linkHtml = `<a href="${url}">${text || url}</a>`;
                document.execCommand('insertHTML', false, linkHtml);
            }

            closeLinkModal();
            updatePreview();
        }

        function handlePaste(e) {
            const clipboardData = e.clipboardData || window.clipboardData;
            const pastedText = clipboardData.getData('text');

            if (pastedText.match(/^https?:\/\//)) {
                e.preventDefault();
                const selection = window.getSelection();
                const selectedText = selection.toString();

                if (selectedText) {
                    const linkHtml = `<a href="${pastedText}">${selectedText}</a>`;
                    document.execCommand('insertHTML', false, linkHtml);
                } else {
                    const linkHtml = `<a href="${pastedText}">${pastedText}</a>`;
                    document.execCommand('insertHTML', false, linkHtml);
                }
                updatePreview();
            }
        }

        function getEditorContent(id) {
            const el = document.getElementById(id);
            if (!el) return '';
            const html = el.innerHTML.trim();
            if (!html || html === '<br>') return '';
            return html;
        }

        function processHtmlForOutput(html, linkColor) {
            if (!html) return '';
            const temp = document.createElement('div');
            temp.innerHTML = html;
            temp.querySelectorAll('a').forEach(a => {
                a.style.color = linkColor;
                a.style.fontFamily = 'arial, helvetica, sans-serif';
                a.style.fontSize = '12px';
                a.removeAttribute('class');
            });
            temp.querySelectorAll('font[color]').forEach(font => {
                const span = document.createElement('span');
                span.style.color = font.getAttribute('color');
                span.innerHTML = font.innerHTML;
                font.replaceWith(span);
            });
            return temp.innerHTML;
        }

        function getSignatureHtml() {
            const name = document.getElementById('name').value;
            const nameLink = document.getElementById('nameLink').value.trim();
            const role = getEditorContent('roleEditor');
            const tagline = getEditorContent('taglineEditor');

            const colorNameBg = document.getElementById('colorNameBg').value;
            const colorNameText = document.getElementById('colorNameText').value;
            const colorBodyText = document.getElementById('colorBodyText').value;
            const colorLink = document.getElementById('colorLink').value;
            const colorSeparator = document.getElementById('colorSeparator').value;
            const colorCredText = document.getElementById('colorCredText').value;

            const socialLinks = getSocialLinks();
            const credentials = getCredentials();

            const roleHtml = processHtmlForOutput(role, colorLink);
            const taglineHtml = processHtmlForOutput(tagline, colorLink);

            // Build name badge - linked or plain
            let nameBadge;
            if (nameLink) {
                nameBadge = `<a href="${nameLink}" rel="noopener noreferrer" style="color:${colorNameText};background:${colorNameBg};padding:0.3rem 0.5rem;font-size:0.8rem;text-decoration:unset" target="_blank"><font face="arial, helvetica, sans-serif" style="text-decoration:unset">${name}</font></a>`;
            } else {
                nameBadge = `<span style="display:inline-block;background:${colorNameBg};color:${colorNameText};padding:0.3rem 0.5rem;font-size:0.8rem;font-family:arial,helvetica,sans-serif">${name}</span>`;
            }

            let html = `<div dir="ltr"><h2 style="font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif;margin:0px 0px 10px;color:rgb(51,51,51);font-size:16px">${nameBadge}</h2>`;

            // Role line
            if (roleHtml) {
                html += `<div><div style="font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif"><span style="color:${colorBodyText};font-family:arial,helvetica,sans-serif;font-size:12px">❯</span><span style="color:${colorBodyText};font-family:arial,helvetica,sans-serif;font-size:12px">&nbsp;${roleHtml}</span></div>`;
            }

            // Tagline line
            if (taglineHtml) {
                html += `<div style="font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif"><span style="color:${colorBodyText};font-family:arial,helvetica,sans-serif;font-size:12px">❯</span><span style="color:${colorBodyText};font-family:arial,helvetica,sans-serif;font-size:12px">&nbsp;${taglineHtml}</span></div>`;
            }

            // Social links
            if (socialLinks.length > 0) {
                html += `<div style="font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif"><font face="arial, helvetica, sans-serif" style="color:rgb(116,120,126)"><br></font>`;
                socialLinks.forEach((link, i) => {
                    if (i > 0) {
                        html += `<span style="color:${colorSeparator};font-size:12px">&nbsp;|&nbsp;</span>`;
                    }
                    html += `<a href="${link.url}" rel="noopener noreferrer" style="font-size:12px;color:${colorLink}" target="_blank"><font style="vertical-align:inherit">${link.platform}</font></a>`;
                });
                html += `</div>`;
            }

            // Credentials
            if (credentials.length > 0) {
                html += `<div style="font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif"><span style="color:rgb(116,120,126)"><span style="color:${colorSeparator};font-size:12px"><br></span></span></div>`;
                credentials.forEach((cred, i) => {
                    const processedCred = processHtmlForOutput(cred, colorLink);
                    html += `<div style="font-family:Roboto,RobotoDraft,Helvetica,Arial,sans-serif;border-left:1px solid ${colorCredText};padding-left:5px"><font color="${colorCredText}" face="arial, helvetica, sans-serif"><span style="font-size:12px;color:${colorCredText}">${processedCred}</span></font></div>`;
                });
            }

            // Close role div if opened
            if (roleHtml) {
                html += `</div>`;
            }

            html += `</div>`;

            return html;
        }

        function updatePreview() {
            document.getElementById('signatureOutput').innerHTML = getSignatureHtml();
        }

        function copySignature() {
            const html = getSignatureHtml();
            const blob = new Blob([html], { type: 'text/html' });
            const plainBlob = new Blob([document.getElementById('signatureOutput').innerText], { type: 'text/plain' });

            navigator.clipboard.write([
                new ClipboardItem({
                    'text/html': blob,
                    'text/plain': plainBlob
                })
            ]).then(() => {
                showFeedback();
            }).catch(() => {
                const signatureEl = document.getElementById('signatureOutput');
                const range = document.createRange();
                range.selectNode(signatureEl);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                document.execCommand('copy');
                window.getSelection().removeAllRanges();
                showFeedback();
            });
        }

        function copyHtml() {
            const html = getSignatureHtml();
            navigator.clipboard.writeText(html).then(() => {
                showFeedback();
            });
        }

        function showFeedback() {
            const feedback = document.getElementById('copyFeedback');
            feedback.classList.add('show');
            setTimeout(() => {
                feedback.classList.remove('show');
            }, 2000);
        }

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('show');
            }
        });

        document.addEventListener('keydown', (e) => {
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                const activeEl = document.activeElement;
                if (activeEl && (activeEl.classList.contains('inline-editor') || activeEl.classList.contains('rich-editor'))) {
                    activeEditor = activeEl;
                    const selection = window.getSelection();
                    if (selection.rangeCount > 0) {
                        savedSelection = selection.getRangeAt(0).cloneRange();
                        document.getElementById('linkText').value = selection.toString();
                    }
                    document.getElementById('linkUrl').value = '';
                    document.getElementById('linkModal').classList.add('show');
                    setTimeout(() => document.getElementById('linkUrl').focus(), 50);
                }
            }

            if (e.key === 'Escape') {
                document.querySelectorAll('.modal.show').forEach(m => m.classList.remove('show'));
                activeEditor = null;
                savedSelection = null;
            }

            if (e.key === 'Enter' && document.getElementById('linkModal').classList.contains('show')) {
                e.preventDefault();
                insertLink();
            }
        });

        updatePreview();
    </script>
</body>
</html>
